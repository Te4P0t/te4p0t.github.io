---
layout: post
title: ç»å…¸ç½‘ç»œç»“æ„çš„pytorchå®ç°
subheading: ç”¨Pytorchå®ç°AlexNetã€VggNetã€ResNet
author: xyccq
categories: æ— 
banner: https://bit.ly/32PAjtM
tags: Machine-Learning Pytorch
sidebar: []
---

ğŸ‘´ç»è¿‡äº†ä¸€å¹´å·¦å³çš„ç†è®ºå­¦ä¹ ï¼Œç»ˆäºåˆ°äº†å®è·µç¯èŠ‚ã€‚ç°é˜¶æ®µç›®çš„æ˜¯å†™ä¸€ä¸ªå¯¹åˆ†å‰²åçš„è½¦ç‰Œå­—ç¬¦è¿›è¡Œåˆ†ç±»çš„åˆ†ç±»ç½‘ç»œã€‚å› æ­¤ç”¨pytorchå¯¹å‡ ç§ç»å…¸çš„ç½‘ç»œç»“æ„è¿›è¡Œå¤ç°å¹¶æµ‹è¯•æ•ˆæœã€‚

## AlexNet

AlexNetè®ºæ–‡åŸæ–‡ï¼š[ImageNet Classification with Deep Convolutional Neural Networks](https://proceedings.neurips.cc/paper/2012/file/c399862d3b9d6b76c8436e924a68c45b-Paper.pdf)

AlexNetç»“æ„å›¾ï¼š

![image-20210205220838444](C:\Users\xieyucheng\AppData\Roaming\Typora\typora-user-images\image-20210205220838444.png)

å¯ä»¥çœ‹å‡ºAlexNetæœ‰5ä¸ªå·ç§¯å±‚å’Œ3ä¸ªå…¨è¿æ¥å±‚ã€‚æ€»å…±8å±‚çš„æ·±åº¦ï¼Œå¤ç°èµ·æ¥è¿˜æ˜¯æ¯”è¾ƒå®¹æ˜“çš„ã€‚

```python
import torch
import torch.nn as nn
import torchvision

class AlexNetbase(nn.Module):
    def __init__(self,num_classes=65):
        super(AlexNetbase,self).__init__()
        self.feature_extraction = nn.Sequential(
            nn.Conv2d(in_channels=3,out_channels=96,kernel_size=11,stride=4,padding=2,bias=False),
            nn.ReLU(inplace=True),
            nn.MaxPool2d(kernel_size=3,stride=2,padding=0),
            nn.Conv2d(in_channels=96,out_channels=192,kernel_size=5,stride=1,padding=2,bias=False),
            nn.ReLU(inplace=True),
            nn.MaxPool2d(kernel_size=3,stride=2,padding=0),
            nn.Conv2d(in_channels=192,out_channels=384,kernel_size=3,stride=1,padding=1,bias=False),
            nn.ReLU(inplace=True),
            nn.Conv2d(in_channels=384,out_channels=256,kernel_size=3,stride=1,padding=1,bias=False),
            nn.ReLU(inplace=True),
            nn.Conv2d(in_channels=256,out_channels=256,kernel_size=3,stride=1,padding=1,bias=False),
            nn.ReLU(inplace=True),
            nn.MaxPool2d(kernel_size=3, stride=2, padding=0),
        )
        self.classifier = nn.Sequential(
            nn.Dropout(p=0.5),
            nn.Linear(in_features=256*6*6,out_features=4096),
            nn.ReLU(inplace=True),
            nn.Dropout(p=0.5),
            nn.Linear(in_features=4096, out_features=4096),
            nn.ReLU(inplace=True),
            nn.Linear(in_features=4096, out_features=num_classes),
        )
    def forward(self,x):
        x = self.feature_extraction(x)
        x = x.view(x.size(0), -1)
        x = self.classifier(x)
        return x

def AlexNet():
  return AlexNetbase()
```





## VggNet

VggNetè®ºæ–‡åŸæ–‡ï¼š[VERY DEEP CONVOLUTIONAL NETWORKS FOR LARGE-SCALE IMAGE RECOGNITION](https://arxiv.org/pdf/1409.1556.pdf%20http://arxiv.org/abs/1409.1556.pdf)

ç»“æ„å›¾ï¼š

![image-20210205221417030](C:\Users\xieyucheng\AppData\Roaming\Typora\typora-user-images\image-20210205221417030.png)

æ ¹æ®æ·±åº¦å¯ä»¥åˆ†ä¸ºvgg11, vgg13, vgg16, vgg19ã€‚

ç›¸æ¯”äºAlexNetï¼ŒVggNetåœ¨å·ç§¯çš„è¿‡ç¨‹ä¸­ä½¿ç”¨äº†å°çš„å·ç§¯æ ¸çš„å †å çš„æ–¹å¼ã€‚ä¸€æ–¹é¢å¢åŠ äº†ç½‘ç»œçš„æ·±åº¦ï¼Œå¦ä¸€æ–¹é¢å‡å°‘äº†è®¡ç®—é‡ã€‚

åœ¨æ„Ÿå—é‡ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œé‡‡å–æ›´å°çš„å·ç§¯æ ¸è¿›è¡Œå †å èƒ½å¤Ÿå‡å°‘å‚æ•°é‡å’Œè¿ç®—é‡ã€‚

ä¾‹ï¼šä¸€ä¸ª5*5çš„å·ç§¯æ ¸çš„å‚æ•°é‡æ˜¯25ï¼Œåœ¨è¿›è¡Œä¹˜åŠ è¿ç®—æ—¶ä¹Ÿè¿›è¡Œäº†25æ¬¡ä¹˜åŠ è¿ç®—ã€‚ä¸€ä¸ª3 *3çš„å·ç§¯æ ¸å‚æ•°é‡9ï¼Œä¹˜åŠ è¿ç®—9æ¬¡ã€‚è€Œ2ä¸ª3 *3å·ç§¯æ ¸å¯¹åº”çš„æ„Ÿå—é‡æ˜¯1ä¸ª5 *5çš„å·ç§¯æ ¸çš„æ„Ÿå—é‡ã€‚

```python
import torch
import torch.nn as nn
import torch.nn.functional as F
import torchvision

class VGGbase(nn.Module):
    def __init__(self, num_classes = 65):
        super(VGGbase, self).__init__()
        # 3 * 224 * 224
        self.conv1 = nn.Sequential(
            nn.Conv2d(in_channels=3, out_channels=64, kernel_size=3, stride=1, padding=1),
            nn.BatchNorm2d(64),
            nn.ReLU()
        )
        self.max_pooling1 = nn.MaxPool2d(kernel_size=2, stride=2)

        # 112 * 112
        self.conv2_1 = nn.Sequential(
            nn.Conv2d(in_channels=64, out_channels=128, kernel_size=3, stride=1, padding=1),
            nn.BatchNorm2d(128),
            nn.ReLU()
        )
        self.conv2_2 = nn.Sequential(
            nn.Conv2d(in_channels=128, out_channels=128, kernel_size=3, stride=1, padding=1),
            nn.BatchNorm2d(128),
            nn.ReLU()
        )
        self.max_pooling2 = nn.MaxPool2d(kernel_size=2, stride=2)


        # 56 * 56
        self.conv3_1 = nn.Sequential(
            nn.Conv2d(in_channels=128, out_channels=256, kernel_size=3, stride=1, padding=1),
            nn.BatchNorm2d(256),
            nn.ReLU()
        )
        self.conv3_2 = nn.Sequential(
            nn.Conv2d(in_channels=256, out_channels=256, kernel_size=3, stride=1, padding=1),
            nn.BatchNorm2d(256),
            nn.ReLU()
        )
        self.max_pooling3 = nn.MaxPool2d(kernel_size=2, stride=2, padding=1)


        # 28 * 28
        self.conv4_1 = nn.Sequential(
            nn.Conv2d(in_channels=256, out_channels=512, kernel_size=3, stride=1, padding=1),
            nn.BatchNorm2d(512),
            nn.ReLU()
        )
        self.conv4_2 = nn.Sequential(
            nn.Conv2d(in_channels=512, out_channels=512, kernel_size=3, stride=1, padding=1),
            nn.BatchNorm2d(512),
            nn.ReLU()
        )
        self.max_pooling4 = nn.MaxPool2d(kernel_size=2, stride=2)

        # 14 * 14

        self.conv5_1 = nn.Sequential(
            nn.Conv2d(in_channels=512, out_channels=512, kernel_size=3, stride=1, padding=1),
            nn.BatchNorm2d(512),
            nn.ReLU()
        )
        self.conv5_2 = nn.Sequential(
            nn.Conv2d(in_channels=512, out_channels=512, kernel_size=3, stride=1, padding=1),
            nn.BatchNorm2d(512),
            nn.ReLU()
        )
        self.max_pooling5 = nn.MaxPool2d(kernel_size=2, stride=2)

        # 7 * 7

        self.classifier = nn.Sequential(
            nn.Linear(in_features = 512 * 7 * 7, out_features = 4096),
            nn.ReLU(),
            nn.Dropout(p = 0.2),
            nn.Linear(in_features = 4096, out_features = 4096),
            nn.ReLU(),
            nn.Dropout(p = 0.2),
            nn.Linear(in_features=4096, out_features = num_classes)

        )
#        self.fc = nn.Linear(512 * 1, num_classes)

    def forward(self, x):
        batchsize = x.size(0)
        out = self.conv1(x)
        out = self.max_pooling1(out)
        out = self.conv2_1(out)
        out = self.conv2_2(out)
        out = self.max_pooling2(out)

        out = self.conv3_1(out)
        out = self.conv3_2(out)
        out = self.max_pooling3(out)

        out = self.conv4_1(out)
        out = self.conv4_2(out)
        out = self.max_pooling4(out)

        out = self.conv5_1(out)
        out = self.conv5_2(out)
        out = self.max_pooling5(out)

        out = out.view(batchsize, -1)
        out = self.classifier(out)
        return out

def VGGNet():
    return VGGbase()
```

ä¸Šè¿°æ˜¯vgg13çš„å¤ç°ï¼Œå¯¹äºä¸åŒæ·±åº¦çš„VggNetæ ¹æ®ä¸Šé¢çš„ç»“æ„å›¾åœ¨ç›¸åº”ä½ç½®åŠ å…¥å¯¹åº”çš„å·ç§¯å±‚å³å¯ã€‚

VggNetåœ¨å®é™…æµ‹è¯•ä¸­æ•ˆæœä¸é”™ï¼Œå¯¹äºè½¦ç‰Œå­—ç¬¦è¯†åˆ«è¿™ä¸ª65åˆ†ç±»çš„ä»»åŠ¡ï¼Œä¸åŒæ·±åº¦ç¬¬ä¸€ä¸ªepochç»“æŸååœ¨æµ‹è¯•é›†ä¸Šçš„å‡†ç¡®ç‡éƒ½èƒ½è¾¾åˆ°90ï¼…å·¦å³ã€‚

![image-20210205222940325](C:\Users\xieyucheng\AppData\Roaming\Typora\typora-user-images\image-20210205222940325.png)



## ResNet

ResNetæ˜¯è·³è¿ç½‘ç»œç»“æ„çš„ä»£è¡¨ï¼Œä¸»è¦çš„æ€æƒ³æ˜¯å¼•å…¥è·³è¿çš„ç»“æ„æ¥é˜²æ­¢æ¢¯åº¦æ¶ˆå¤±çš„é—®é¢˜ï¼Œè¿›è€Œå¯ä»¥è¿›ä¸€æ­¥åŠ å¤§ç½‘ç»œæ·±åº¦ã€‚

åœ¨ResNetçš„åŸºç¡€ä¸Šæœ‰å¾ˆå¤šæ‰©å±•çš„ç½‘ç»œç»“æ„ï¼šResNeXtã€DenseNetã€WideResNetã€ResNet In ResNetã€Inception-ResNetç­‰ç­‰ã€‚

ResNetè®ºæ–‡åŸæ–‡ï¼š[Deep Residual Learning for Image Recognition](https://arxiv.org/pdf/1512.03385.pdf)

ResNetç»“æ„å›¾

![image-20210205224149482](C:\Users\xieyucheng\AppData\Roaming\Typora\typora-user-images\image-20210205224149482.png)

ç›¸æ¯”AlexNetå’ŒVggNetç½‘ç»œæ·±åº¦æ˜æ˜¾å¢åŠ 

è·³è¿ç»“æ„å›¾

![image-20210205224324052](C:\Users\xieyucheng\AppData\Roaming\Typora\typora-user-images\image-20210205224324052.png)

å…·ä½“å®ç°å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š[PyTorchå®ç°ResNetäº²èº«å®è·µ](https://zhuanlan.zhihu.com/p/263526658)





## æ€»ç»“

ä¸‡é‡Œé•¿å¾è¿ˆå‡ºäº†ç¬¬ä¸€æ­¥ã€‚å½“çœ‹åˆ°è®­ç»ƒç»ˆäºè·‘äº†èµ·æ¥ï¼Œlossåœ¨ç¨³æ­¥æ”¶æ•›ï¼Œæ­£ç¡®ç‡ä¸æ–­æé«˜æ—¶å†…å¿ƒç»ˆäºæ„Ÿåˆ°äº†å–œæ‚¦ã€‚è¿™ä¸€å¹´çš„ç†è®ºå­¦ä¹ ä¹Ÿç®—æ˜¯æ²¡æœ‰ç™½è´¹ã€‚

å½“ç„¶è¿™åªæ˜¯ç¬¬ä¸€æ­¥ï¼Œåç»­è¿˜æœ‰æ›´å¤šçš„ä»»åŠ¡ã€‚ä»»é‡è€Œé“è¿œï¼Œç»§ç»­å­¦ä¹ ã€‚